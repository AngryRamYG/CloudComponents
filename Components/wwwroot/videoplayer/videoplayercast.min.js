var cjs,__awaiter=this&&this.__awaiter||function(n,o,t,e){return new(t||(t=Promise))(function(s,r){function c(n){try{i(e.next(n))}catch(n){r(n)}}function l(n){try{i(e.throw(n))}catch(n){r(n)}}function i(n){var o;n.done?s(n.value):(o=n.value,o instanceof t?o:new t(function(n){n(o)})).then(c,l)}i((e=e.apply(n,o||[])).next())})},__generator=this&&this.__generator||function(n,o){var t,e,s,r,c={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return r={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function l(r){return function(l){return function(r){if(t)throw new TypeError("Generator is already executing.");for(;c;)try{if(t=1,e&&(s=2&r[0]?e.return:r[0]?e.throw||((s=e.return)&&s.call(e),0):e.next)&&!(s=s.call(e,r[1])).done)return s;switch(e=0,s&&(r=[2&r[0],s.value]),r[0]){case 0:case 1:s=r;break;case 4:return c.label++,{value:r[1],done:!1};case 5:c.label++,e=r[1],r=[0];continue;case 7:r=c.ops.pop(),c.trys.pop();continue;default:if(!(s=(s=c.trys).length>0&&s[s.length-1])&&(6===r[0]||2===r[0])){c=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){c.label=r[1];break}if(6===r[0]&&c.label<s[1]){c.label=s[1],s=r;break}if(s&&c.label<s[2]){c.label=s[2],c.ops.push(r);break}s[2]&&c.ops.pop(),c.trys.pop();continue}r=o.call(n,c)}catch(n){r=[6,n],e=0}finally{t=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,l])}}},firstCasting=!0,castPosition=null,castJsUrl="https://cdnjs.cloudflare.com/ajax/libs/castjs/5.2.0/cast.min.js";function loadJs(n){return new Promise(function(o,t){for(var e=document.getElementsByTagName("script"),s=0;s<e.length;s++)if(e[s].src==n)return void o(null);var r=document.createElement("script");r.src=n,r.type="text/javascript",r.onload=function(){o(null)},r.onerror=function(){console.error("Failed to load script: "+n),t("Failed to load script")},document.body.appendChild(r)})}export function init(){return __awaiter(this,void 0,void 0,function(){var n=this;return __generator(this,function(o){switch(o.label){case 0:return console.log(cjs),console.log(1),[4,loadJs(castJsUrl)];case 1:return o.sent(),console.log(2),[2,new Promise(function(o,t){cjs||(cjs=new Castjs),console.log(3),cjs.on("event",function(t){return __awaiter(n,void 0,void 0,function(){var n,e;return __generator(this,function(s){switch(s.label){case 0:return n=null,e=!0,"timeupdate"===t&&(n=cjs.time,e=!1),e&&console.log(4),e&&console.log(t),e&&console.log(5),"available"===t?(console.log(6),o(null),[2]):(e&&console.log(7),firstCasting&&"playing"===t&&(null!==castPosition&&(cjs.seek(castPosition),castPosition=null),firstCasting=!1),e&&console.log(8),[4,DotNet.invokeMethodAsync("AngryMonkey.Cloud.Components","HandleCastJsEventStatic",t,n)]);case 1:return s.sent(),e&&console.log(9),[2]}})})}),console.log(4.1),cjs.on("error",function(n){console.log("error: "+n),t(n)}),console.log(4.2)})]}})})}export function startCasting(n,o){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){return console.log(100),console.log(cjs),t=cjs.connected&&cjs.src===n,console.log(101),t||(firstCasting=!0,console.log(102),cjs.cast(n,{title:"Coverbox TV"}),console.log(103)),void 0!==o&&(firstCasting?castPosition=o:cjs.seek(o)),console.log(104),cjs.play(),console.log(105),[2]})})}export function stopCasting(){cjs.available&&cjs.disconnect()}export function pauseCasting(){cjs.available&&cjs.pause()}export function playCasting(){cjs.available&&cjs.play()}